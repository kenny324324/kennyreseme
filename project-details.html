<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>專案詳細資訊 - 余亮廷 Kenny Yu</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <!-- 進場淡入遮罩（你的 JS 會用到） -->
  <div class="page-fade-in-overlay"></div>

  <!-- Navigation（原樣保留） -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-logo" style="margin-left: -20px;">
        <a href="#" class="back-btn" id="backBtn" style="display: flex; align-items: center; gap: 8px; color: #333; text-decoration: none; font-weight: 500; background: #f8f9fa; padding: 8px 16px; border-radius: 15px; transition: all 0.3s ease; margin: 0;">
          <i class="fas fa-arrow-left"></i>
          <span>返回首頁</span>
        </a>
      </div>
      <div class="nav-logo" style="margin-left: auto;">
        <span class="logo-text" id="projectTitle">專案詳細資訊</span>
      </div>
    </div>
  </nav>

  <!-- 作品集詳細內容（骨架版，吃你現有 CSS） -->
  <section class="project-details">
    <div class="container">



      <!-- 主視覺 + 簡介 + 技術堆疊 + 專案背景 -->
      <div class="project-content">
        <div class="project-image-section">
          <div class="project-image">
            <img id="projectDetailImage" src="documents/profolio source/Bus/detailcover.png" alt="專案詳細圖片" class="project-detail-image">
          </div>
        </div>

        <div class="project-info">
          <!-- 一句話電梯簡介 -->
          <div class="project-description" id="projectDescription">
            跳蛙公車2.0幫助民眾在規劃公車行程時更快地完成<span class="highlight">購票</span>和在地圖上自訂創建<span class="highlight">募集路線</span>
          </div>

          <!-- 技術標籤 -->
          <div class="project-tech-stack">
            <div class="tech-tags">
              <span class="tech-tag">.NET MAUI</span>
              <span class="tech-tag">Google登入</span>
              <span class="tech-tag">地圖整合</span>
              <span class="tech-tag">Firebase推播</span>
            </div>
          </div>

          <!-- 專案背景 -->
          <div class="project-features">
            <h3 class="category-title">專案背景</h3>
            <div class="project-background-content">
              <p>跳蛙公車2.0是受公車處委託的改版專案，主要目的是將既有APP進行全面升級，引進全新的視覺配色設計，並在募集路線功能中加入直觀的地圖顯示功能。</p>
              
              <p>專案啟動會議中，我們針對現有系統的痛點進行深入分析：優化首頁資訊推送、重新設計路線顯示邏輯、改進跨縣市路線的視覺區分、調整訂票介面並加入座位圖例說明，以及導入雙重認證機制解決密碼問題。</p>
              
              <p><strong>我的角色：</strong>負責 Figma UI/UX 設計規劃、.NET MAUI 跨平台開發實作、以及 Google 登入、Firebase 推播等第三方 API 系統整合。</p>
            </div>
          </div>
        </div>
      </div>

      <!-- 規劃與流程（設計 / 開發） -->
      <div class="project-content">
        <div class="project-info" id="design-process">
          <h3 class="category-title">規劃與流程｜設計（Figma）</h3>
          <div class="process-content">
            <p>載入中...</p>
          </div>
          <div class="design-image-section" id="design-image-section" style="display: none;">
            <h4 style="margin-top: 20px; margin-bottom: 10px; font-size: 14px;"><span class="highlight">Figma 設計流程圖</span></h4>
            <div class="design-image-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; margin-bottom: 20px;">
              <img id="figma-design-image" src="" alt="Figma 設計流程圖" style="width: 100%; height: auto; display: block;">
            </div>
          </div>
        </div>
        <div class="project-info" id="development-process">
          <h3 class="category-title">規劃與流程｜開發（技術）</h3>
          <div class="process-content">
            <p>載入中...</p>
          </div>
          <div class="tech-image-section" id="tech-image-section" style="display: none;">
            <h4 style="margin-top: 20px; margin-bottom: 10px; font-size: 14px;"><span class="highlight">技術架構圖</span></h4>
            <div class="tech-image-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; margin-bottom: 20px; background: white;">
              <img id="tech-architecture-image" src="" alt="技術架構圖" style="width: 100%; height: auto; display: block;">
            </div>
          </div>
        </div>
      </div>

      <!-- 挑戰與解決（#1 / #2） -->
      <div class="project-content" id="challenges-section">
        <div class="project-info" id="challenge-1">
          <h3 class="category-title">挑戰與解決 #1</h3>
          <div class="challenge-content">
            <p>載入中...</p>
          </div>
        </div>
        <div class="project-info" id="challenge-2">
          <h3 class="category-title">挑戰與解決 #2</h3>
          <div class="challenge-content">
            <p>載入中...</p>
          </div>
        </div>
      </div>

      <!-- 設計亮點 -->
      <div class="project-content" id="highlights-section" style="grid-template-columns: 1fr;">
        <div class="project-info" id="design-highlights">
          <h3 class="category-title">設計亮點</h3>
          
          <!-- 水平排列的亮點容器 -->
          <div class="highlights-container" style="display: flex; gap: 30px; justify-content: space-between; flex-wrap: wrap; align-items: flex-start;">
            
            <!-- 亮點 1: 首頁動態輪播公告 -->
            <div class="highlight-item" id="highlight-1" style="flex: 1; min-width: 280px; max-width: 350px;">
              <!-- 標題和文字說明區域 - 固定高度 -->
              <div class="highlight-text-area" style="min-height: 120px; display: flex; flex-direction: column;">
                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 16px; font-weight: bold;">首頁動態輪播公告</h4>
                <div class="highlight-content" style="line-height: 1.6; color: #555; margin-bottom: 20px; font-size: 14px; flex: 1;">
                  <p>載入中...</p>
                </div>
              </div>
              
              <!-- 影片區域 -->
              <div class="highlight-video-section" id="highlight-1-video" style="display: block;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">動態展示</span></h5>
                <div class="highlight-video-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9; width: 100%;">
                  <video id="highlight-1-vid" autoplay muted loop playsinline style="width: 100%; height: auto; display: none; vertical-align: top;">
                    <source src="" type="video/quicktime">
                    您的瀏覽器不支援影片播放。
                  </video>
                  <div id="video-placeholder" style="color: #999; text-align: center; padding: 30px; min-height: 150px; display: flex; align-items: center; justify-content: center; font-size: 14px;">
                    <p>載入影片中...</p>
                  </div>
                </div>
              </div>
              
              <div class="highlight-image-section" id="highlight-1-image" style="display: none;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">靜態截圖</span></h5>
                <div class="highlight-image-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9;">
                  <img id="highlight-1-img" src="" alt="首頁動態輪播公告截圖" style="width: 100%; height: auto; display: block; object-fit: contain;">
                </div>
              </div>
            </div>

            <!-- 亮點 2: 互動式地圖介面 -->
            <div class="highlight-item" id="highlight-2" style="flex: 1; min-width: 280px; max-width: 350px;">
              <!-- 標題和文字說明區域 - 固定高度 -->
              <div class="highlight-text-area" style="min-height: 120px; display: flex; flex-direction: column;">
                <div class="highlight-content" style="line-height: 1.6; color: #555; margin-bottom: 20px; font-size: 14px; flex: 1;">
                  <p>載入中...</p>
                </div>
              </div>
              
              <!-- 影片區域 -->
              <div class="highlight-video-section" id="highlight-2-video" style="display: block;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">動態展示</span></h5>
                <div class="highlight-video-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9; width: 100%;">
                  <video id="highlight-2-vid" autoplay muted loop playsinline style="width: 100%; height: auto; display: none; vertical-align: top;">
                    <source src="" type="video/quicktime">
                    您的瀏覽器不支援影片播放。
                  </video>
                  <div id="video-placeholder-2" style="color: #999; text-align: center; padding: 30px; min-height: 150px; display: flex; align-items: center; justify-content: center; font-size: 14px;">
                    <p>載入影片中...</p>
                  </div>
                </div>
              </div>
              
              <div class="highlight-image-section" id="highlight-2-image" style="display: none;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">介面截圖</span></h5>
                <div class="highlight-image-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9;">
                  <img id="highlight-2-img" src="" alt="互動式地圖介面截圖" style="width: 100%; height: auto; display: block; object-fit: contain;">
                </div>
              </div>
            </div>

            <!-- 亮點 3: 訂購路線列表設計 -->
            <div class="highlight-item" id="highlight-3" style="flex: 1; min-width: 280px; max-width: 350px;">
              <!-- 標題和文字說明區域 - 固定高度 -->
              <div class="highlight-text-area" style="min-height: 120px; display: flex; flex-direction: column;">
                <div class="highlight-content" style="line-height: 1.6; color: #555; margin-bottom: 20px; font-size: 14px; flex: 1;">
                  <p>載入中...</p>
                </div>
              </div>
              
              <!-- 影片區域 -->
              <div class="highlight-video-section" id="highlight-3-video" style="display: block;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">動態展示</span></h5>
                <div class="highlight-video-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9; width: 100%;">
                  <video id="highlight-3-vid" autoplay muted loop playsinline style="width: 100%; height: auto; display: none; vertical-align: top;">
                    <source src="" type="video/quicktime">
                    您的瀏覽器不支援影片播放。
                  </video>
                  <div id="video-placeholder-3" style="color: #999; text-align: center; padding: 30px; min-height: 150px; display: flex; align-items: center; justify-content: center; font-size: 14px;">
                    <p>載入影片中...</p>
                  </div>
                </div>
              </div>
              
              <div class="highlight-image-section" id="highlight-3-image" style="display: none;">
                <h5 style="margin: 0 0 10px 0; color: #666; font-size: 12px; font-weight: bold;"><span class="highlight">介面截圖</span></h5>
                <div class="highlight-image-container" style="border: 1px solid #e0e0e0; border-radius: 8px; overflow: hidden; background: #f9f9f9;">
                  <img id="highlight-3-img" src="" alt="訂購路線列表截圖" style="width: 100%; height: auto; display: block; object-fit: contain;">
                </div>
              </div>
            </div>
            
          </div>
        </div>
      </div>

      <!-- 反思與收穫 / 下一步 -->
      <div class="project-content">
        <div class="project-info">
          <h3 class="category-title">反思與收穫</h3>
          <ul class="features-list">
            <li><strong>深化技能：</strong>提升了 .NET MAUI 跨平台開發技能和複雜 API 整合能力</li>
            <li><strong>完整流程：</strong>強化了從 UI/UX 設計到實作的完整流程經驗</li>
            <li><strong>用戶體驗：</strong>學習了如何平衡技術實作與使用者體驗的要求</li>
          </ul>
        </div>
        <div class="project-info">
          <h3 class="category-title">未來改進</h3>
          <ul class="features-list">
            <li><strong>效能優化：</strong>優化地圖載入效能，提升大量資料處理速度</li>
            <li><strong>功能擴展：</strong>增加更多支付方式選項，提供更彈性的購票體驗</li>
            <li><strong>数據分析：</strong>強化使用者行為分析功能，提供更好的服務建議</li>
          </ul>
        </div>
      </div>

    </div>

    <!-- 連結 -->
    <div class="project-links">
      <a href="https://www.figma.com/proto/Gw633NeO0kIuw1PbpVU1Dr/%E8%B7%B3%E8%9B%99%E5%85%AC%E8%BB%8AUI%EF%BC%88%E6%9A%96%E8%89%B2%EF%BC%89?page-id=0%3A1&node-id=1-1582&p=f&viewport=227%2C406%2C0.02&t=5NtMAnc7cMrpQ9DD-1&scaling=scale-down&content-scaling=fixed&starting-point-node-id=1%3A966" target="_blank" class="btn btn-outline"><i class="fab fa-figma"></i>Figma 設計原型</a>
      <a href="https://apps.apple.com/tw/app/%E8%B7%B3%E8%9B%99%E5%85%AC%E8%BB%8A2-0/id6667097903" target="_blank" class="btn btn-outline"><i class="fab fa-apple"></i>App Store</a>
      <a href="https://play.google.com/store/apps/details?id=tw.wowbus.www&hl=zh_TW" target="_blank" class="btn btn-outline"><i class="fab fa-google-play"></i>Google Play</a>
    </div>
  </section>

  <script>
    // 導航欄滾動效果（原樣）
    window.addEventListener('scroll', function() {
      const navbar = document.querySelector('.navbar');
      if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    });

    // 載入時：設定標題 / 進場動畫 / 返回
    document.addEventListener('DOMContentLoaded', function() {
      const urlParams = new URLSearchParams(window.location.search);
      const projectName = urlParams.get('project');
      const techTags = urlParams.get('tech');

      if (projectName) {
        document.getElementById('projectTitle').textContent = projectName;
        document.title = `${projectName} - 專案詳細資訊 - 余亮廷 Kenny Yu`;
        
        // 動態載入專案內容
        loadProjectContent(projectName);
      }

      // 如果有技術標籤，則顯示在技術堆疊區塊
      if (techTags) {
        const techTagsArray = techTags.split(',');
        const techTagsContainer = document.querySelector('.tech-tags');
        if (techTagsContainer) {
          techTagsContainer.innerHTML = '';
          techTagsArray.forEach(tag => {
            const techTag = document.createElement('span');
            techTag.className = 'tech-tag';
            techTag.textContent = tag.trim();
            techTagsContainer.appendChild(techTag);
          });
        }
      }

      // 觸發進場淡入
      setTimeout(() => {
        const fadeInOverlay = document.querySelector('.page-fade-in-overlay');
        if (fadeInOverlay) fadeInOverlay.classList.add('fade-in');
      }, 100);

      // 返回首頁
      const backBtn = document.getElementById('backBtn');
      if (backBtn) {
        backBtn.addEventListener('click', function(e) {
          e.preventDefault();
          fadeOutAndReturn();
        });
      }
    });

    // 專案名稱到資料夾名稱的映射
    const projectFolderMap = {
      '跳蛙公車2.0': 'Bus',
      '跳蛙公車': 'Bus',
      '跳蛙購票APP': 'Bus',
      'Bus': 'Bus',
      '今皓TUAN AI助理APP': 'Tuan',
      '今皓AI APP': 'Tuan',
      'Tuan': 'Tuan',
      '島嶼生吐司 手持POS': 'POS',
      '島嶼生吐司 POS': 'POS',
      'POS': 'POS',
      'JustAI 客服系統': 'Justai',
      'Justai': 'Justai',
      'Mino 待辦清單': 'Mino',
      'Mino': 'Mino',
      'MIsh 個人書櫃': 'MIsh',
      'MIsh': 'MIsh'
    };

    // 動態載入專案內容
    function loadProjectContent(projectName) {
      // 根據專案名稱獲取對應的資料夾名稱
      const folderName = projectFolderMap[projectName] || projectName;
      console.log('專案名稱:', projectName, '資料夾名稱:', folderName);
      
      // 載入專案描述
      fetch(`documents/profolio source/${folderName}/description.txt`)
        .then(response => {
          if (response.ok) {
            return response.text();
          } else {
            // 如果檔案不存在，顯示預設內容
            return '（一句話：這個產品幫助【對象】在【情境】中更快/更順地【動作】）';
          }
        })
        .then(description => {
          const projectDescription = document.getElementById('projectDescription');
          if (projectDescription) {
            // 處理文字檔中的標記語法
            // **文字** → <strong>文字</strong> (純粗體)
            // ##文字## → <span class="highlight">文字</span> (highlight粗體)
            let processedDescription = description
              .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
              .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
            projectDescription.innerHTML = processedDescription;
          }
        })
        .catch(error => {
          console.log('載入描述檔案失敗，使用預設內容');
          const projectDescription = document.getElementById('projectDescription');
          if (projectDescription) {
            projectDescription.textContent = '（一句話：這個產品幫助【對象】在【情境】中更快/更順地【動作】）';
          }
        });

      // 載入專案背景（如果存在 background.txt）
      fetch(`documents/profolio source/${folderName}/background.txt`)
        .then(response => {
          if (response.ok) {
            return response.text();
          }
          return null;
        })
        .then(background => {
          if (background) {
            const backgroundContent = document.querySelector('.project-background-content');
            if (backgroundContent) {
              // 將文字按段落分割並格式化，同時處理粗體標記
              const paragraphs = background.split('\n\n').filter(p => p.trim());
              backgroundContent.innerHTML = paragraphs.map(p => {
                // 處理雙重標記語法
                // **文字** → <strong>文字</strong> (純粗體)
                // ##文字## → <span class="highlight">文字</span> (highlight粗體)
                const processedText = p.trim()
                  .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                  .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                return `<p>${processedText}</p>`;
              }).join('\n');
            }
          }
        })
        .catch(error => {
          console.log('載入背景檔案失敗，使用預設內容');
        });

      // 載入規劃與流程內容（如果存在 plan.txt）
      fetch(`documents/profolio source/${folderName}/plan.txt`)
        .then(response => {
          if (response.ok) {
            return response.text();
          }
          return null;
        })
        .then(planContent => {
          if (planContent) {
            // 分割設計流程和開發流程
            const sections = planContent.split('開發流程｜技術');
            
            if (sections.length >= 2) {
              // 設計流程部分
              const designSection = sections[0].replace('設計流程｜Figma', '').trim();
              const designProcessDiv = document.querySelector('#design-process .process-content');
              if (designProcessDiv && designSection) {
                const designParagraphs = designSection.split('\n\n').filter(p => p.trim());
                designProcessDiv.innerHTML = designParagraphs.map(p => {
                  const processedText = p.trim()
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                  return `<p>${processedText}</p>`;
                }).join('\n');
              }
              
              // 開發流程部分
              const devSection = sections[1].trim();
              const devProcessDiv = document.querySelector('#development-process .process-content');
              if (devProcessDiv && devSection) {
                const devParagraphs = devSection.split('\n\n').filter(p => p.trim());
                devProcessDiv.innerHTML = devParagraphs.map(p => {
                  const processedText = p.trim()
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                  return `<p>${processedText}</p>`;
                }).join('\n');
              }
            }
          }
        })
        .catch(error => {
          console.log('載入規劃檔案失敗，使用預設內容');
        });

      // 載入 Figma 設計截圖（如果存在）
      const figmaDesignImage = document.getElementById('figma-design-image');
      const designImageSection = document.getElementById('design-image-section');
      if (figmaDesignImage && designImageSection) {
        const figmaImagePath = `documents/profolio source/${folderName}/figma-design.png`;
        
        // 檢查圖片是否存在
        const testImage = new Image();
        testImage.onload = function() {
          figmaDesignImage.src = figmaImagePath;
          designImageSection.style.display = 'block';
        };
        testImage.onerror = function() {
          console.log('Figma 設計截圖不存在，隱藏圖片區塊');
        };
        testImage.src = figmaImagePath;
      }

      // 載入技術架構圖（如果存在）
      const techArchImage = document.getElementById('tech-architecture-image');
      const techImageSection = document.getElementById('tech-image-section');
      if (techArchImage && techImageSection) {
        const techImagePath = `documents/profolio source/${folderName}/tech-architecture.svg`;
        
        // 檢查 SVG 是否存在
        fetch(techImagePath)
          .then(response => {
            if (response.ok) {
              techArchImage.src = techImagePath;
              techImageSection.style.display = 'block';
            }
          })
          .catch(error => {
            console.log('技術架構圖不存在，隱藏圖片區塊');
          });
      }

      // 載入挑戰與解決內容（如果存在 challenges.txt）
      fetch(`documents/profolio source/${folderName}/challenges.txt`)
        .then(response => {
          if (response.ok) {
            return response.text();
          }
          return null;
        })
        .then(challengesContent => {
          if (challengesContent) {
            // 分割兩個挑戰
            const challenges = challengesContent.split('挑戰與解決 #2：');
            
            if (challenges.length >= 2) {
              // 挑戰 #1
              const challenge1Section = challenges[0].replace('挑戰與解決 #1：', '').trim();
              const challenge1Div = document.querySelector('#challenge-1 .challenge-content');
              const challenge1Title = document.querySelector('#challenge-1 .category-title');
              if (challenge1Div && challenge1Section) {
                // 提取標題
                const lines = challenge1Section.split('\n');
                const titleLine = lines[0];
                if (challenge1Title) {
                  challenge1Title.textContent = `挑戰與解決 #1：${titleLine}`;
                }
                
                const content = lines.slice(2).join('\n'); // 跳過標題和空行
                const paragraphs = content.split('\n\n').filter(p => p.trim());
                challenge1Div.innerHTML = paragraphs.map(p => {
                  const processedText = p.trim()
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                  return `<p>${processedText}</p>`;
                }).join('\n');
              }
              
              // 挑戰 #2
              const challenge2Section = challenges[1].trim();
              const challenge2Div = document.querySelector('#challenge-2 .challenge-content');
              const challenge2Title = document.querySelector('#challenge-2 .category-title');
              if (challenge2Div && challenge2Section) {
                // 提取標題
                const lines = challenge2Section.split('\n');
                const titleLine = lines[0];
                if (challenge2Title) {
                  challenge2Title.textContent = `挑戰與解決 #2：${titleLine}`;
                }
                
                const content = lines.slice(2).join('\n'); // 跳過標題和空行
                const paragraphs = content.split('\n\n').filter(p => p.trim());
                challenge2Div.innerHTML = paragraphs.map(p => {
                  const processedText = p.trim()
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                  return `<p>${processedText}</p>`;
                }).join('\n');
              }
            }
          }
        })
        .catch(error => {
          console.log('載入挑戰檔案失敗，使用預設內容');
        });

      // 載入設計與技術亮點內容（如果存在 highlights.txt）
      fetch(`documents/profolio source/${folderName}/highlights.txt`)
        .then(response => {
          if (response.ok) {
            return response.text();
          }
          return null;
        })
        .then(highlightsContent => {
          if (highlightsContent) {
            // 分割三個亮點
            const highlights = highlightsContent.split(/亮點[123]：/).filter(section => section.trim());
            
            // 載入每個亮點
            highlights.forEach((highlight, index) => {
              if (highlight.trim()) {
                const highlightNum = index + 1;
                const lines = highlight.trim().split('\n');
                const title = lines[0]; // 第一行是標題
                const content = lines.slice(2).join('\n'); // 跳過標題和空行
                
                // 更新標題和內容
                const highlightDiv = document.querySelector(`#highlight-${highlightNum} .highlight-content`);
                if (highlightDiv) {
                  const processedContent = content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/##(.*?)##/g, '<span class="highlight">$1</span>');
                  
                  // 水平佈局：所有亮點都使用相同格式
                  if (highlightNum === 1) {
                    // 亮點1有獨立的標題元素
                    const titleElement = highlightDiv.parentElement.parentElement.querySelector('h4');
                    if (titleElement) {
                      titleElement.innerHTML = title;
                    }
                    highlightDiv.innerHTML = `<p>${processedContent}</p>`;
                  } else {
                    // 其他亮點需要在內容中添加標題，使用與亮點1相同的字體大小
                    highlightDiv.innerHTML = `<h4 style="margin: 0 0 15px 0; color: #333; font-size: 16px; font-weight: bold;">${title}</h4><p style="line-height: 1.6; color: #555;">${processedContent}</p>`;
                  }
                }
                
                // 載入對應的圖片（如果存在）
                const imageSection = document.getElementById(`highlight-${highlightNum}-image`);
                const imageElement = document.getElementById(`highlight-${highlightNum}-img`);
                if (imageSection && imageElement) {
                  const imagePath = `documents/profolio source/${folderName}/highlight-${highlightNum}.png`;
                  
                  // 檢查圖片是否存在
                  const testImage = new Image();
                  testImage.onload = function() {
                    imageElement.src = imagePath;
                    imageSection.style.display = 'block';
                  };
                  testImage.onerror = function() {
                    // 如果 .png 不存在，嘗試 .gif
                    const gifPath = `documents/profolio source/${folderName}/highlight-${highlightNum}.gif`;
                    const testGif = new Image();
                    testGif.onload = function() {
                      imageElement.src = gifPath;
                      imageSection.style.display = 'block';
                    };
                    testGif.onerror = function() {
                      console.log(`亮點 ${highlightNum} 的圖片不存在`);
                    };
                    testGif.src = gifPath;
                  };
                  testImage.src = imagePath;
                }

                // 處理所有亮點的影片
                const videoFiles = {
                  1: 'carousell.mov',
                  2: 'map.mov',
                  3: 'list.mov'
                };
                
                if (videoFiles[highlightNum]) {
                  const videoSection = document.getElementById(`highlight-${highlightNum}-video`);
                  const videoElement = document.getElementById(`highlight-${highlightNum}-vid`);
                  const placeholder = document.getElementById(`video-placeholder${highlightNum === 1 ? '' : '-' + highlightNum}`);
                  
                  if (videoSection && videoElement) {
                    const videoPath = `documents/profolio source/${folderName}/media/${videoFiles[highlightNum]}`;
                    
                    // 檢查影片是否存在
                    fetch(videoPath, { method: 'HEAD' })
                      .then(response => {
                        if (response.ok) {
                          videoElement.querySelector('source').src = videoPath;
                          videoElement.load();
                          videoElement.style.display = 'block';
                          if (placeholder) placeholder.style.display = 'none';
                          
                          // 確保影片載入後自動播放
                          videoElement.addEventListener('loadeddata', function() {
                            videoElement.play().catch(error => {
                              console.log(`亮點${highlightNum}影片自動播放被阻擋，這是正常的瀏覽器行為`);
                            });
                          });
                        } else {
                          if (placeholder) placeholder.innerHTML = '<p>影片載入失敗</p>';
                        }
                      })
                      .catch(error => {
                        console.log(`亮點${highlightNum}影片不存在`);
                        if (placeholder) placeholder.innerHTML = '<p>找不到影片檔案</p>';
                      });
                  }
                }
              }
            });
          }
        })
        .catch(error => {
          console.log('載入亮點檔案失敗，使用預設內容');
        });

      // 載入專案詳細圖片
      const detailImage = document.getElementById('projectDetailImage');
      if (detailImage) {
        const imagePath = `documents/profolio source/${folderName}/detailcover.png`;
        detailImage.src = imagePath;
        detailImage.alt = `${projectName}專案圖片`;
        
        // 圖片載入失敗時顯示佔位符
        detailImage.onerror = function() {
          this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+CiAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIExvYWRpbmcuLi48L3RleHQ+Cjwvc3ZnPg==';
          this.alt = '圖片載入中...';
        };
      }
    }

    // 返回首頁的淡出動畫
    function fadeOutAndReturn() {
      const fadeOverlay = document.createElement('div');
      fadeOverlay.className = 'page-fade-overlay';
      document.body.appendChild(fadeOverlay);
      setTimeout(() => {
        fadeOverlay.classList.add('fade-out');
        setTimeout(() => {
          window.location.href = 'index.html#projects';
        }, 500);
      }, 50);
    }
  </script>
</body>
</html>